/*
Add contents of data.js here:
 */

import { data } from './color'

const Accent = partial('Accent')
const Accent_r = partial('Accent_r')
const Blues = partial('Blues')
const Blues_r = partial('Blues_r')
const BrBG = partial('BrBG')
const BrBG_r = partial('BrBG_r')
const BuGn = partial('BuGn')
const BuGn_r = partial('BuGn_r')
const BuPu = partial('BuPu')
const BuPu_r = partial('BuPu_r')
const CMRmap = partial('CMRmap')
const CMRmap_r = partial('CMRmap_r')
const Dark2 = partial('Dark2')
const Dark2_r = partial('Dark2_r')
const GnBu = partial('GnBu')
const GnBu_r = partial('GnBu_r')
const Greens = partial('Greens')
const Greens_r = partial('Greens_r')
const Greys = partial('Greys')
const Greys_r = partial('Greys_r')
const OrRd = partial('OrRd')
const OrRd_r = partial('OrRd_r')
const Oranges = partial('Oranges')
const Oranges_r = partial('Oranges_r')
const PRGn = partial('PRGn')
const PRGn_r = partial('PRGn_r')
const Paired = partial('Paired')
const Paired_r = partial('Paired_r')
const Pastel1 = partial('Pastel1')
const Pastel1_r = partial('Pastel1_r')
const Pastel2 = partial('Pastel2')
const Pastel2_r = partial('Pastel2_r')
const PiYG = partial('PiYG')
const PiYG_r = partial('PiYG_r')
const PuBu = partial('PuBu')
const PuBu_r = partial('PuBu_r')
const PuBuGn = partial('PuBuGn')
const PuBuGn_r = partial('PuBuGn_r')
const PuOr = partial('PuOr')
const PuOr_r = partial('PuOr_r')
const PuRd = partial('PuRd')
const PuRd_r = partial('PuRd_r')
const Purples = partial('Purples')
const Purples_r = partial('Purples_r')
const RdBu = partial('RdBu')
const RdBu_r = partial('RdBu_r')
const RdGy = partial('RdGy')
const RdGy_r = partial('RdGy_r')
const RdPu = partial('RdPu')
const RdPu_r = partial('RdPu_r')
const RdYlBu = partial('RdYlBu')
const RdYlBu_r = partial('RdYlBu_r')
const RdYlGn = partial('RdYlGn')
const RdYlGn_r = partial('RdYlGn_r')
const Reds = partial('Reds')
const Reds_r = partial('Reds_r')
const Set1 = partial('Set1')
const Set1_r = partial('Set1_r')
const Set2 = partial('Set2')
const Set2_r = partial('Set2_r')
const Set3 = partial('Set3')
const Set3_r = partial('Set3_r')
const Spectral = partial('Spectral')
const Spectral_r = partial('Spectral_r')
const Wistia = partial('Wistia')
const Wistia_r = partial('Wistia_r')
const YlGn = partial('YlGn')
const YlGn_r = partial('YlGn_r')
const YlGnBu = partial('YlGnBu')
const YlGnBu_r = partial('YlGnBu_r')
const YlOrBr = partial('YlOrBr')
const YlOrBr_r = partial('YlOrBr_r')
const YlOrRd = partial('YlOrRd')
const YlOrRd_r = partial('YlOrRd_r')
const afmhot = partial('afmhot')
const afmhot_r = partial('afmhot_r')
const autumn = partial('autumn')
const autumn_r = partial('autumn_r')
const binary = partial('binary')
const binary_r = partial('binary_r')
const bone = partial('bone')
const bone_r = partial('bone_r')
const brg = partial('brg')
const brg_r = partial('brg_r')
const bwr = partial('bwr')
const bwr_r = partial('bwr_r')
const cividis = partial('cividis')
const cividis_r = partial('cividis_r')
const cool = partial('cool')
const cool_r = partial('cool_r')
const coolwarm = partial('coolwarm')
const coolwarm_r = partial('coolwarm_r')
const copper = partial('copper')
const copper_r = partial('copper_r')
const cubehelix = partial('cubehelix')
const cubehelix_r = partial('cubehelix_r')
const flag = partial('flag')
const flag_r = partial('flag_r')
const gist_earth = partial('gist_earth')
const gist_earth_r = partial('gist_earth_r')
const gist_gray = partial('gist_gray')
const gist_gray_r = partial('gist_gray_r')
const gist_heat = partial('gist_heat')
const gist_heat_r = partial('gist_heat_r')
const gist_ncar = partial('gist_ncar')
const gist_ncar_r = partial('gist_ncar_r')
const gist_rainbow = partial('gist_rainbow')
const gist_rainbow_r = partial('gist_rainbow_r')
const gist_stern = partial('gist_stern')
const gist_stern_r = partial('gist_stern_r')
const gist_yarg = partial('gist_yarg')
const gist_yarg_r = partial('gist_yarg_r')
const gnuplot = partial('gnuplot')
const gnuplot_r = partial('gnuplot_r')
const gnuplot2 = partial('gnuplot2')
const gnuplot2_r = partial('gnuplot2_r')
const gray = partial('gray')
const gray_r = partial('gray_r')
const hot = partial('hot')
const hot_r = partial('hot_r')
const hsv = partial('hsv')
const hsv_r = partial('hsv_r')
const inferno = partial('inferno')
const inferno_r = partial('inferno_r')
const jet = partial('jet')
const jet_r = partial('jet_r')
const magma = partial('magma')
const magma_r = partial('magma_r')
const nipy_spectral = partial('nipy_spectral')
const nipy_spectral_r = partial('nipy_spectral_r')
const ocean = partial('ocean')
const ocean_r = partial('ocean_r')
const pink = partial('pink')
const pink_r = partial('pink_r')
const plasma = partial('plasma')
const plasma_r = partial('plasma_r')
const prism = partial('prism')
const prism_r = partial('prism_r')
const rainbow = partial('rainbow')
const rainbow_r = partial('rainbow_r')
const seismic = partial('seismic')
const seismic_r = partial('seismic_r')
const spring = partial('spring')
const spring_r = partial('spring_r')
const summer = partial('summer')
const summer_r = partial('summer_r')
const tab10 = partial('tab10')
const tab10_r = partial('tab10_r')
const tab20 = partial('tab20')
const tab20_r = partial('tab20_r')
const tab20b = partial('tab20b')
const tab20b_r = partial('tab20b_r')
const tab20c = partial('tab20c')
const tab20c_r = partial('tab20c_r')
const terrain = partial('terrain')
const terrain_r = partial('terrain_r')
const turbo = partial('turbo')
const turbo_r = partial('turbo_r')
const twilight = partial('twilight')
const twilight_r = partial('twilight_r')
const twilight_shifted = partial('twilight_shifted')
const twilight_shifted_r = partial('twilight_shifted_r')
const viridis = partial('viridis')
const viridis_r = partial('viridis_r')
const winter = partial('winter')
const winter_r = partial('winter_r')

/*
Define auxiliary functions for evaluating colormaps
 */

/**
 * @param {number} x
 * @param {string} name
 * @param {boolean} reverse
 */
export function evaluate_cmap(x: number, name: string, reverse: boolean) {
  /**
   * Evaluate colormap `name` at some value `x`.
   * @param {number} x - The value (between 0 and 1) at which to evaluate the colormap.
   * @param {string} name - The name of the colormap (see matplotlib documentation).
   * @reverse {boolean} reverse - Whether or not to reverse the colormap.
   * @return {list} - A 3-tuple (R, G, B) containing the color assigned to `x`.
   */

  // Ensure that the value of `x` is valid (i.e., 0 <= x <= 1)
  if (x < 0 || x > 1) {
    //debugger
    console.error('Illegal value for x! Must be in [0, 1].')
    return [0, 0, 0]
  }

  // Ensure that `name` is a valid colormap
  if (!(name in data)) {
    console.error('Colormap ' + name + 'does not exist!')
    return [0, 0, 0]
  }

  // We can get the reverse colormap by evaluating colormap(1-x)
  if (reverse === true) {
    x = 1 - x
  }

  // Get the colors and whether or not we need to interpolate
  const colormapData: Record<
    string,
    { interpolate: boolean; colors: number[][] }
  > = data
  const colormap = colormapData[name]

  if (colormap) {
    const colors = colormap.colors
    const interpolate = colormap.interpolate

    if (interpolate === true) {
      return interpolated(x, colors)
    } else {
      return qualitative(x, colors)
    }
  } else {
    alert(`Colormap ${name} does not exist!`)
    return [0, 0, 0]
  }
}

function interpolated(x: number, colors: number[][]) {
  const lo = Math.floor(x * (colors.length - 1))
  const hi = Math.ceil(x * (colors.length - 1))

  const r = Math.round(
    (((colors?.[lo]?.[0] ?? 0) + (colors?.[hi]?.[0] ?? 0)) / 2) * 255,
  )
  const g = Math.round(
    (((colors?.[lo]?.[1] ?? 0) + (colors?.[hi]?.[1] ?? 0)) / 2) * 255,
  )
  const b = Math.round(
    (((colors?.[lo]?.[2] ?? 0) + (colors?.[hi]?.[2] ?? 0)) / 2) * 255,
  )
  return [r, g, b]
}

function qualitative(x: number, colors: number[][]) {
  let idx = 0
  while (x > (idx + 1) / (colors.length - 0)) {
    idx++
  }
  const r = Math.round((colors?.[idx]?.[0] ?? 0) * 255)
  const g = Math.round((colors?.[idx]?.[1] ?? 0) * 255)
  const b = Math.round((colors?.[idx]?.[2] ?? 0) * 255)
  return [r, g, b]
}

function partial(name: string) {
  if (name.endsWith('_r')) {
    return function (x: number) {
      return evaluate_cmap(x, name.substring(0, name.length - 2), true)
    }
  } else {
    return function (x: number) {
      return evaluate_cmap(x, name, false)
    }
  }
}
